# ch4作业
## 编程作业
### 重写 sys_get_time 和 sys_task_info
实现了一个名为write_in_by_va的函数，该函数可以将一个字符串写入到指定虚拟地址处，包括跨页面的写入。
### mmap 和 munmap
mmap，首先处理参数错误的部分情况，然后通过从任务管理器中获取memory_set，在memory_set中添加新的一段内存MapArea，并在刚创建MapArea时检查是否存在已经被映射到页。
munmap，首先处理参数错误的部分情况，然后通过从任务管理器中获取memory_set，在memory_set中删除以start为起始地址的MapArea。

## 问答作业
### 1.
PPN为长度44位的物理页号；
仅当 V(Valid) 位为 1 时，页表项才是合法的；
R/W/X 分别控制索引到这个页表项的对应虚拟页面是否允许读/写/取指；
U 控制索引到这个页表项的对应虚拟页面是否在 CPU 处于 U 特权级的情况下是否被允许访问；
A(Accessed) 记录自从页表项上的这一位被清零之后，页表项的对应虚拟页面是否被访问过；
D(Dirty) 则记录自从页表项上的这一位被清零之后，页表项的对应虚拟页表是否被修改过。

### 2.
缺页异常可能是访问了未映射的虚拟地址，也可能是访问了已映射但权限不正确的虚拟地址。

Lazy跨页节省内存，缺页异常时才分配物理页面；提升系统执行速度；加速程序的启动时间。

10G内存需要页表项的大小约为2^24个字节，即16MB。

使用Lazy策略，当发生缺页时，会产生缺页异常，此时操作系统会分配物理页面，并将虚拟地址映射到物理地址。

页面失效在PTE上的有效位V被置0。

### 3.
单页表情况下，在切换任务时，切换token。

内核页面设置U为0。

异常中断处理时，不需要切换页表。

双页表情况下，切换特权级时更换页表；单页表在切换任务时更换页表。

## 荣誉准则
1.在完成本次实验的过程（含此前学习的过程）中，我曾分别与 以下各位 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

《你交流的对象说明》

2.此外，我也参考了 以下资料 ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

《你参考的资料说明》

3.我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4.我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。